<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="UTF-8">
  
  <title>Boundless : Introduction to PostGIS : Section 6: Simple SQL</title>

  <link rel="profile" href="http://gmpg.org/xfn/11">
  <link rel="stylesheet" href="http://boundlessgeo.com/wp-content/themes/open-geo/style.css" type="text/css"/>

<link rel="stylesheet" id="style-css" href="http://boundlessgeo.com/wp-content/themes/open-geo/style.css?ver=3.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="_static/extra.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!-- <link rel="stylesheet" type="text/css" href="http://opengeo.org/include/superfish/css/superfish.css" media="screen" /> -->

  <script type="text/javascript" src="http://boundlessgeo.com/wordpress/wp-includes/js/jquery/jquery.js?ver=1.10.2"></script>
  <script type="text/javascript" src="http://boundlessgeo.com/wordpress/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1"></script>

  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="_static/jquery.js"></script>
  <script type="text/javascript" src="_static/underscore.js"></script>
  <script type="text/javascript" src="_static/doctools.js"></script>
  <script type="text/javascript" src="_static/searchtools.js"></script>
  <script type="text/javascript" src="searchindex.js"></script>
  <!-- 
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/jquery-1.2.6.min.js"></script> 
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/hoverIntent.js"></script>
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/superfish.js"></script>
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/supersubs.js"></script>
  <script>
	$(document).ready(function(){
		$("ul.sf-menu").supersubs({
		}).superfish();  // call supersubs first, then superfish, so that subs are
						 // not display:none when measuring. Call before initialising
						 // containing tabs for same reason.
	});
	</script>
  -->
  <link rel="shortcut icon" href="_static/favicon.ico"/>
      <link rel="top" title="Introduction to PostGIS" href="index.html" />
      <link rel="next" title="Section 7: Simple SQL Exercises" href="simple_sql_exercises.html" />
      <link rel="prev" title="Section 5: About our data" href="about_data.html" />

<script type="text/javascript" src="//use.typekit.net/ijz1lwt.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

<!--[if lt IE 9]>
<script src="http://boundlessgeo.com/wp-content/themes/open-geo/js/html5.js" type="text/javascript"></script>
<![endif]-->


</head>
<body class="page">

	<div id="wrapper">
		<header id="masthead" class="site-header" role="banner">
			<div class="container">
				<a href="http://boundlessgeo.com/" rel="home" id="logo"><img src="http://boundlessgeo.com/wp-content/themes/open-geo/images/logo.png"></a>

				<div class="pull-right">
					<div class="pull-left">
						<div class="menu-main-container">
							<ul id="menu-main" class="menu">
                <li class="solutions-primary menu-item menu-item-type-post_type menu-item-object-page menu-item-22"><a href="http://boundlessgeo.com/solutions/">Solutions</a></li>
                <li class="resources-primary menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-16 current_page_item menu-item-23"><a href="http://boundlessgeo.com/resources/">Resources</a></li>
                <li class="about-primary menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="http://boundlessgeo.com/about/">About</a></li>
                <li class="support-primary menu-item menu-item-type-post_type menu-item-object-page menu-item-25"><a href="http://boundlessgeo.com/support/">Support</a></li>
							</ul>
						</div>
					</div>
					<div class="search dropdown">
					  <a class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="search-icon"></i></a>
						  <div class="dropdown-menu" role="menu" aria-labelledby="dLabel">
							  <form method="get" id="searchform" class="searchform" action="http://boundlessgeo.com/" role="search">
								  <label for="s" class="screen-reader-text">Search</label>
							  <input type="search" class="field" name="s" value="" id="s" placeholder="Search …">
							  <input type="submit" class="submit" id="searchsubmit" value="Search">
							  </form>
						  </div>
					</div>
					<div class="download-link">
						<ul id="menu-download-link" class="menu">
							<li id="menu-item-5817" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5817">
								<a href="http://boundlessgeo.com/download/">Download</a>
							</li>
						</ul>
					</div>
				</div>

			</div><!--closes container-->

		</header>
<section class="resources page-resources">
  <div class="secondarynav">
     <div class="container">
       	<div class="menu-resources-container">
	   <ul id="menu-resources" class="menu">
              <li id="menu-item-5892" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-16 current_page_item menu-item-5892"><a href="http://boundlessgeo.com/resources/" >Overview</a></li>
              <li id="menu-item-7099" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7099"><a href="http://boundlessgeo.com/resources/documentation/" >Documentation</a></li>
              <li id="menu-item-5885" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5885"><a href="http://boundlessgeo.com/resources/trainings/" >Trainings</a></li>
              <li id="menu-item-6432" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6432"><a href="http://workshops.boundlessgeo.com/" >Workshops</a></li>
              <li id="menu-item-5318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5318"><a href="http://boundlessgeo.com/resources/case-studies/" >Case Studies</a></li>
              <li id="menu-item-5891" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5891"><a href="http://boundlessgeo.com/resources/white-papers/" >White Papers</a></li>
           </ul>
         </div>		
      </div>
    </div>
</section>
<header class="page-header">
	<div class="container">
		<h1 class="page-title"><a href="index.html">Introduction to PostGIS</a></h1>
		<p>PostGIS extends PostgreSQL with robust spatial database management capabilities. <a href="http://boundlessgeo.com/solutions/solutions-software/postgis/">More info</a></p>
	</div>
</header><div id="pageheading"><div class="contents"><h1>Introduction to PostGIS</h1></div></div>

  <div id="content" class="contents">
  <!--
<div id="breadcrumbs">
  <a href="http://boundlessgeo.com/">Home</a> &raquo;
  <a href="http://boundlessgeo.com/resources/">Resources</a> &raquo;
  <a href="http://workshops.boundlessgeo.com/">Workshops</a> &raquo;
  <a href="index.html">Introduction to PostGIS</a>
  
     &raquo; <a href="">Section 6: Simple SQL</a>
</div> -->

  <div id="rightbar_main">
      
  <div class="section" id="section-6-simple-sql">
<span id="simple-sql"></span><h1>Section 6: Simple SQL<a class="headerlink" href="#section-6-simple-sql" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="glossary.html#term-sql"><em class="xref std std-term">SQL</em></a>, or &#8220;Structured Query Language&#8221;, is a means of asking questions of, and updating data in, relational databases. You have already seen SQL when we created our first database.  Recall:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">postgis_full_version</span><span class="p">();</span>
</pre></div>
</div>
<p>But that was a question about the database.  Now that we&#8217;ve loaded data into our database, let&#8217;s use SQL to ask questions of the data! For example,</p>
<blockquote>
<div>&#8220;What are the names of all the neighborhoods in New York City?&#8221;</div></blockquote>
<p>Open up the SQL query window in pgAdmin by clicking the SQL button</p>
<img alt="_images/pgadmin_05.png" src="_images/pgadmin_05.png" />
<p>then enter the following query in to the query window</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">name</span> <span class="k">FROM</span> <span class="n">nyc_neighborhoods</span><span class="p">;</span>
</pre></div>
</div>
<p>and click the <strong>Execute Query</strong> button (the green triangle).</p>
<img alt="_images/pgadmin_08.png" src="_images/pgadmin_08.png" />
<p>The query will run for a few (mili)seconds and return the 129 results.</p>
<img alt="_images/pgadmin_09.png" src="_images/pgadmin_09.png" />
<p>But what exactly happened here?  To understand, let&#8217;s begin with the four &#8220;verbs&#8221; of SQL,</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">SELECT</span></tt>, returns rows in response to a query</li>
<li><tt class="docutils literal"><span class="pre">INSERT</span></tt>, adds new rows to a table</li>
<li><tt class="docutils literal"><span class="pre">UPDATE</span></tt>, alters existing rows in a table</li>
<li><tt class="docutils literal"><span class="pre">DELETE</span></tt>, removes rows from a table</li>
</ul>
<p>We will be working almost exclusively with <tt class="docutils literal"><span class="pre">SELECT</span></tt> in order to ask questions of tables using spatial functions.</p>
<div class="section" id="select-queries">
<h2>SELECT queries<a class="headerlink" href="#select-queries" title="Permalink to this headline">¶</a></h2>
<p>A select query is generally of the form:</p>
<div class="highlight-python"><pre>SELECT some_columns FROM some_data_source WHERE some_condition;</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For a synopsis of all <tt class="docutils literal"><span class="pre">SELECT</span></tt> parameters, see the <a class="reference external" href="http://www.postgresql.org/docs/2.1/interactive/sql-select.html">PostgresSQL documentation</a>.</p>
</div>
<p>The <tt class="docutils literal"><span class="pre">some_columns</span></tt> are either column names or functions of column values. The <tt class="docutils literal"><span class="pre">some_data_source</span></tt> is either a single table, or a composite table created by joining two tables on a key or condition. The <tt class="docutils literal"><span class="pre">some_condition</span></tt> is a filter that restricts the number of rows to be returned.</p>
<blockquote>
<div>&#8220;What are the names of all the neighborhoods in Brooklyn?&#8221;</div></blockquote>
<p>We return to our <tt class="docutils literal"><span class="pre">nyc_neighborhoods</span></tt> table with a filter in hand.  The table contains all the neighborhoods in New York, but we only want the ones in Brooklyn.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">name</span>
  <span class="k">FROM</span> <span class="n">nyc_neighborhoods</span>
  <span class="k">WHERE</span> <span class="n">boroname</span> <span class="o">=</span> <span class="s1">&#39;Brooklyn&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>The query will run for even fewer (mili)seconds and return the 23 results.</p>
<p>Sometimes we will need to apply a function to the results of our query. For example,</p>
<blockquote>
<div>&#8220;What is the number of letters in the names of all the neighborhoods in Brooklyn?&#8221;</div></blockquote>
<p>Fortunately, PostgreSQL has a string length function, <strong class="command">char_length(string)</strong>.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="k">char_length</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="k">FROM</span> <span class="n">nyc_neighborhoods</span>
  <span class="k">WHERE</span> <span class="n">boroname</span> <span class="o">=</span> <span class="s1">&#39;Brooklyn&#39;</span><span class="p">;</span>
</pre></div>
</div>
<p>Often, we are less interested in the individual rows than in a statistic that applies to all of them. So knowing the lengths of the neighborhood names might be less interesting than knowing the average length of the names. Functions that take in multiple rows and return a single result are called &#8220;aggregate&#8221; functions.</p>
<p>PostgreSQL has a series of built-in aggregate functions, including the general purpose <strong class="command">avg()</strong> for average values and <strong class="command">stddev()</strong> for standard deviations.</p>
<blockquote>
<div>&#8220;What is the average number of letters and standard deviation of number of letters in the names of all the neighborhoods in Brooklyn?&#8221;</div></blockquote>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="k">avg</span><span class="p">(</span><span class="k">char_length</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span> <span class="n">stddev</span><span class="p">(</span><span class="k">char_length</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="k">FROM</span> <span class="n">nyc_neighborhoods</span>
  <span class="k">WHERE</span> <span class="n">boroname</span> <span class="o">=</span> <span class="s1">&#39;Brooklyn&#39;</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-python"><pre>         avg         |       stddev
---------------------+--------------------
 11.7391304347826087 | 3.9105613559407395</pre>
</div>
<p>The aggregate functions in our last example were applied to every row in the result set. What if we want the summaries to be carried out over smaller groups within the overall result set? For that we add a <tt class="docutils literal"><span class="pre">GROUP</span> <span class="pre">BY</span></tt> clause. Aggregate functions often need an added <tt class="docutils literal"><span class="pre">GROUP</span> <span class="pre">BY</span></tt> statement to group the result-set by one or more columns.</p>
<blockquote>
<div>&#8220;What is the average number of letters in the names of all the neighborhoods in New York City, reported by borough?&#8221;</div></blockquote>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">boroname</span><span class="p">,</span> <span class="k">avg</span><span class="p">(</span><span class="k">char_length</span><span class="p">(</span><span class="n">name</span><span class="p">)),</span> <span class="n">stddev</span><span class="p">(</span><span class="k">char_length</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
  <span class="k">FROM</span> <span class="n">nyc_neighborhoods</span>
  <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">boroname</span><span class="p">;</span>
</pre></div>
</div>
<p>We include the <tt class="docutils literal"><span class="pre">boroname</span></tt> column in the output result so we can determine which statistic applies to which borough. In an aggregate query, you can only output columns that are either (a) members of the grouping clause or (b) aggregate functions.</p>
<div class="highlight-python"><pre>   boroname    |         avg         |       stddev
---------------+---------------------+--------------------
 Brooklyn      | 11.7391304347826087 | 3.9105613559407395
 Manhattan     | 11.8214285714285714 | 4.3123729948325257
 The Bronx     | 12.0416666666666667 | 3.6651017740975152
 Queens        | 11.6666666666666667 | 5.0057438272815975
 Staten Island | 12.2916666666666667 | 5.2043390480959474</pre>
</div>
</div>
<div class="section" id="function-list">
<h2>Function List<a class="headerlink" href="#function-list" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://www.postgresql.org/docs/current/static/functions-aggregate.html#FUNCTIONS-AGGREGATE-TABLE">avg(expression)</a>: PostgreSQL aggregate function that returns the average value of a numeric column.</p>
<p><a class="reference external" href="http://www.postgresql.org/docs/current/static/functions-string.html">char_length(string)</a>: PostgreSQL string function that returns the number of character in a string.</p>
<p><a class="reference external" href="http://www.postgresql.org/docs/current/static/functions-aggregate.html#FUNCTIONS-AGGREGATE-STATISTICS-TABLE">stddev(expression)</a>: PostgreSQL aggregate function that returns the standard deviation of input values.</p>
</div>
</div>


      <!-- Next/Prev -->
      <div class="selfclear pagination-nav">
          <div class="left"><strong>Previous</strong>: <a href="about_data.html" title="previous chapter">Section 5: About our data</a></div>
          <div class="right"><strong>Next</strong>: <a href="simple_sql_exercises.html" title="next chapter">Section 7: Simple SQL Exercises</a></div>
      </div>

  </div> <!-- rightbar_main -->

  <div id="rightbar_bar">
    
      <div id="toc" class="section">
        <h4 class="pngfix">Page Contents</h4>
        <ul>
<li><a class="reference internal" href="#">Section 6: Simple SQL</a><ul>
<li><a class="reference internal" href="#select-queries">SELECT queries</a></li>
<li><a class="reference internal" href="#function-list">Function List</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <p style="margin-top:1em"><b>Previous:</b> <a href="about_data.html" title="previous chapter">Section 5: About our data</a></p>
          <p><b>Next:</b> <a href="simple_sql_exercises.html" title="next chapter">Section 7: Simple SQL Exercises</a></p>
          </ul>
        </div>

   <h4>About Boundless</h4>
   <p>Boundless provides <a href="http://boundlessgeo.com/solutions/">commercial open source software</a> for internet mapping and geospatial application development. We are dedicated to the growth and support of open source software.</p>

    <h4>License</h4>
    <p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Non Commercial-Attribution-Share Alike 3.0 United States License</a>.  Feel free to use this material, but we ask that you please retain the Boundless branding, logos and style.</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a></p>
<!--
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="simple_sql_exercises.html" title="Section 7: Simple SQL Exercises"
       accesskey="N">next</a></li>
  <li>
    <a href="about_data.html" title="Section 5: About our data"
       accesskey="P">previous</a>|</li>
</ul> -->
  </div> <!-- rightbar_bar -->

  </div> <!-- content -->
  <div id="footer">
    <footer id="colophon" class="site-footer" role="contentinfo">
		<div class="container">
			<div class="row">
				<div class="span2">
					<h5>Solutions</h5>
					<div class="footer-solutions-menu">
						<ul id="menu-solutions" class="menu">
							<li><a href="http://boundlessgeo.com/solutions/">Overview</a></li>
							<li><a href="http://boundlessgeo.com/opengeo-suite/">OpenGeo Suite</a></li>
							<li><a href="http://boundlessgeo.com/solutions/mapmeter/">MapMeter</a></li>
							<li><a href="http://boundlessgeo.com/solutions/solutions-software/">Software</a></li>
							<li><a href="http://boundlessgeo.com/solutions/solutions-industry/">Industries</a></li>
						</ul>
					</div>
				</div>
				<div class="span2">
					<h5>Resources</h5>
					<div class="footer-resources-menu">
						<ul id="menu-resources" class="menu">
              <li><a href="http://boundlessgeo.com/resources/">Overview</a></li>
							<li><a href="http://boundlessgeo.com/documentation/">Documentation</a></li>
							<li><a href="http://boundlessgeo.com/resources/trainings/">Trainings</a></li>
							<li><a href="http://workshops.boundlessgeo.com/">Workshops</a></li>
							<li><a href="http://boundlessgeo.com/case-studies/">Case Studies</a></li>
							<li><a href="http://boundlessgeo.com/resources/white-papers/">White Papers</a></li>
						</ul>
					</div>
				</div>
				<div class="span2">
					<h5>About Us</h5>
					<div class="footer-about-menu">
						<ul id="menu-about-menu" class="menu">
              <li><a href="http://boundlessgeo.com/about/">Overview</a></li>
							<li><a href="http://boundlessgeo.com/why-boundless/">Why Boundless</a></li>
							<li><a href="http://boundlessgeo.com/about/team/">Team</a></li>
							<li><a href="http://boundlessgeo.com/resources/careers/">Careers</a></li>
							<li><a href="http://boundlessgeo.com/resources/partners/">Partners</a></li>
							<li><a href="http://boundlessgeo.com/blog/">Blog</a></li>
							<li><a href="http://boundlessgeo.com/resources/news/">News &amp; Media</a></li>
              <li><a href="http://boundlessgeo.com/general-information/">Contact</a></li>
            </ul></div>
  				</div>

				<div class="span6 site-info">

					<div class="row-fluid">
						<div class="span6">
							<h5>Contact</h5>
							<p class="address">
								<span>155 Water Street, Suite 4-10</span>
								<span>Brooklyn, NY 11201</span>
								<span>1-877-673-6436</span>
								<span>contact@boundlessgeo.com</span>
							</p>
						</div>
						<div class="span6">
							<span class="social"><i class="twitter"></i><a href="https://twitter.com/boundlessgeo" target="_blank">Follow us on Twitter</a></span>
							<span class="social"><i class="linkedIn"></i><a href="http://www.linkedin.com/company/boundlessgeo" target="_blank">Follow us on Linkedin</a></span>
						</div>
					</div>

				</div>
			</div>
			<div class="row">
				<div class="span12 footer-sub-menu">
					<div class="menu-footer-menu-container">
						<ul id="menu-footer-menu" class="menu">
							<li><a href="http://boundlessgeo.com/terms-service/">Terms of Service</a></li>
							<li><a href="http://boundlessgeo.com/privacy-policy/">Privacy Policy</a></li>
							<li><a href="http://boundlessgeo.com/site-map/">Site Map</a></li>
							<li><a href="http://boundlessgeo.com/">© Boundless</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<a class="question btn btn-primary" href="http://boundlessgeo.com/general-information/?contact-variable=ask_a_question"><i class="bubble"></i>Ask A Question</a>
	</footer>
  </div><!-- footer -->

</div><!-- container -->

<script type="text/javascript" src="http://boundlessgeo.com/wp-content/themes/open-geo/js/dropdown.js"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3879903-6");
pageTracker._trackPageview();
} catch(err) {}
</script>

  </body>
</html>