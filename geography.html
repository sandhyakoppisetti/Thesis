<!DOCTYPE html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
  <meta charset="UTF-8">
  
  <title>Boundless : Introduction to PostGIS : Section 17: Geography</title>

  <link rel="profile" href="http://gmpg.org/xfn/11">
  <link rel="stylesheet" href="http://boundlessgeo.com/wp-content/themes/open-geo/style.css" type="text/css"/>

<link rel="stylesheet" id="style-css" href="http://boundlessgeo.com/wp-content/themes/open-geo/style.css?ver=3.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="_static/extra.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!-- <link rel="stylesheet" type="text/css" href="http://opengeo.org/include/superfish/css/superfish.css" media="screen" /> -->

  <script type="text/javascript" src="http://boundlessgeo.com/wordpress/wp-includes/js/jquery/jquery.js?ver=1.10.2"></script>
  <script type="text/javascript" src="http://boundlessgeo.com/wordpress/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1"></script>

  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <script type="text/javascript" src="_static/jquery.js"></script>
  <script type="text/javascript" src="_static/underscore.js"></script>
  <script type="text/javascript" src="_static/doctools.js"></script>
  <script type="text/javascript" src="_static/searchtools.js"></script>
  <script type="text/javascript" src="searchindex.js"></script>
  <!-- 
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/jquery-1.2.6.min.js"></script> 
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/hoverIntent.js"></script>
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/superfish.js"></script>
  <script type="text/javascript" src="http://opengeo.org/include/superfish/js/supersubs.js"></script>
  <script>
	$(document).ready(function(){
		$("ul.sf-menu").supersubs({
		}).superfish();  // call supersubs first, then superfish, so that subs are
						 // not display:none when measuring. Call before initialising
						 // containing tabs for same reason.
	});
	</script>
  -->
  <link rel="shortcut icon" href="_static/favicon.ico"/>
      <link rel="top" title="Introduction to PostGIS" href="index.html" />
      <link rel="next" title="Section 18: Geometry Constructing Functions" href="geometry_returning.html" />
      <link rel="prev" title="Section 16: Projection Exercises" href="projection_exercises.html" />

<script type="text/javascript" src="//use.typekit.net/ijz1lwt.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

<!--[if lt IE 9]>
<script src="http://boundlessgeo.com/wp-content/themes/open-geo/js/html5.js" type="text/javascript"></script>
<![endif]-->


</head>
<body class="page">

	<div id="wrapper">
		<header id="masthead" class="site-header" role="banner">
			<div class="container">
				<a href="http://boundlessgeo.com/" rel="home" id="logo"><img src="http://boundlessgeo.com/wp-content/themes/open-geo/images/logo.png"></a>

				<div class="pull-right">
					<div class="pull-left">
						<div class="menu-main-container">
							<ul id="menu-main" class="menu">
                <li class="solutions-primary menu-item menu-item-type-post_type menu-item-object-page menu-item-22"><a href="http://boundlessgeo.com/solutions/">Solutions</a></li>
                <li class="resources-primary menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-16 current_page_item menu-item-23"><a href="http://boundlessgeo.com/resources/">Resources</a></li>
                <li class="about-primary menu-item menu-item-type-post_type menu-item-object-page menu-item-24"><a href="http://boundlessgeo.com/about/">About</a></li>
                <li class="support-primary menu-item menu-item-type-post_type menu-item-object-page menu-item-25"><a href="http://boundlessgeo.com/support/">Support</a></li>
							</ul>
						</div>
					</div>
					<div class="search dropdown">
					  <a class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="search-icon"></i></a>
						  <div class="dropdown-menu" role="menu" aria-labelledby="dLabel">
							  <form method="get" id="searchform" class="searchform" action="http://boundlessgeo.com/" role="search">
								  <label for="s" class="screen-reader-text">Search</label>
							  <input type="search" class="field" name="s" value="" id="s" placeholder="Search …">
							  <input type="submit" class="submit" id="searchsubmit" value="Search">
							  </form>
						  </div>
					</div>
					<div class="download-link">
						<ul id="menu-download-link" class="menu">
							<li id="menu-item-5817" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5817">
								<a href="http://boundlessgeo.com/download/">Download</a>
							</li>
						</ul>
					</div>
				</div>

			</div><!--closes container-->

		</header>
<section class="resources page-resources">
  <div class="secondarynav">
     <div class="container">
       	<div class="menu-resources-container">
	   <ul id="menu-resources" class="menu">
              <li id="menu-item-5892" class="menu-item menu-item-type-post_type menu-item-object-page current-menu-item page_item page-item-16 current_page_item menu-item-5892"><a href="http://boundlessgeo.com/resources/" >Overview</a></li>
              <li id="menu-item-7099" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-7099"><a href="http://boundlessgeo.com/resources/documentation/" >Documentation</a></li>
              <li id="menu-item-5885" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5885"><a href="http://boundlessgeo.com/resources/trainings/" >Trainings</a></li>
              <li id="menu-item-6432" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6432"><a href="http://workshops.boundlessgeo.com/" >Workshops</a></li>
              <li id="menu-item-5318" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5318"><a href="http://boundlessgeo.com/resources/case-studies/" >Case Studies</a></li>
              <li id="menu-item-5891" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5891"><a href="http://boundlessgeo.com/resources/white-papers/" >White Papers</a></li>
           </ul>
         </div>		
      </div>
    </div>
</section>
<header class="page-header">
	<div class="container">
		<h1 class="page-title"><a href="index.html">Introduction to PostGIS</a></h1>
		<p>PostGIS extends PostgreSQL with robust spatial database management capabilities. <a href="http://boundlessgeo.com/solutions/solutions-software/postgis/">More info</a></p>
	</div>
</header><div id="pageheading"><div class="contents"><h1>Introduction to PostGIS</h1></div></div>

  <div id="content" class="contents">
  <!--
<div id="breadcrumbs">
  <a href="http://boundlessgeo.com/">Home</a> &raquo;
  <a href="http://boundlessgeo.com/resources/">Resources</a> &raquo;
  <a href="http://workshops.boundlessgeo.com/">Workshops</a> &raquo;
  <a href="index.html">Introduction to PostGIS</a>
  
     &raquo; <a href="">Section 17: Geography</a>
</div> -->

  <div id="rightbar_main">
      
  <div class="section" id="section-17-geography">
<span id="geography"></span><h1>Section 17: Geography<a class="headerlink" href="#section-17-geography" title="Permalink to this headline">¶</a></h1>
<p>It is very common to have data in which the coordinate are &#8220;geographics&#8221; or &#8220;latitude/longitude&#8221;.</p>
<p>Unlike coordinates in Mercator, UTM, or Stateplane, geographic coordinates are <strong>not cartesian coordinates</strong>. Geographic coordinates do not represent a linear distance from an origin as plotted on a plane.  Rather, these <strong>spherical coordinates</strong> describe angular coordinates on a globe. In spherical coordinates a point is specified by the angle of rotation from a reference meridian (longitude), and the angle from the equator (latitude).</p>
<img alt="_images/cartesian_spherical.jpg" class="inline" src="_images/cartesian_spherical.jpg" />
<p>You can treat geographic coordinates as approximate cartesian coordinates and continue to do spatial calculations. However, measurements of distance, length and area will be nonsensical. Since spherical coordinates measure <strong>angular</strong> distance, the units are in &#8220;degrees.&#8221; Further, the approximate results from indexes and true/false tests like intersects and contains can become terribly wrong. The distance between points get larger as problem areas like the poles or the international dateline are approached.</p>
<p>For example, here are the coordinates of Los Angeles and Paris.</p>
<ul class="simple">
<li>Los Angeles: <tt class="docutils literal"><span class="pre">POINT(-118.4079</span> <span class="pre">33.9434)</span></tt></li>
<li>Paris: <tt class="docutils literal"><span class="pre">POINT(2.3490</span> <span class="pre">48.8533)</span></tt></li>
</ul>
<p>The following calculates the distance between Los Angeles and Paris using the standard PostGIS cartesian <strong class="command">ST_Distance(geometry, geometry)</strong>.  Note that the SRID of 4326 declares a geographic spatial reference system.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">ST_Distance</span><span class="p">(</span>
  <span class="n">ST_GeometryFromText</span><span class="p">(</span><span class="s1">&#39;POINT(-118.4079 33.9434)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">),</span> <span class="c1">-- Los Angeles (LAX)</span>
  <span class="n">ST_GeometryFromText</span><span class="p">(</span><span class="s1">&#39;POINT(2.5559 49.0083)&#39;</span><span class="p">,</span> <span class="mi">4326</span><span class="p">)</span>     <span class="c1">-- Paris (CDG)</span>
  <span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">121.898285970107</span>
</pre></div>
</div>
<p>Aha! 121! But, what does that mean?</p>
<p>The units for spatial reference 4326 are degrees. So our answer is 121 degrees. But (again), what does that mean?</p>
<p>On a sphere, the size of one &#8220;degree square&#8221; is quite variable, becoming smaller as you move away from the equator. Think of the meridians (vertical lines) on the globe getting closer to each other as you go towards the poles. So, a distance of 121 degrees doesn&#8217;t <em>mean</em> anything. It is a nonsense number.</p>
<p>In order to calculate a meaningful distance, we must treat geographic coordinates not as approximate cartesian coordinates but rather as true spherical coordinates.  We must measure the distances between points as true paths over a sphere &#8211; a portion of a great circle.</p>
<p>Starting with version 1.5, PostGIS provides this functionality through the <tt class="docutils literal"><span class="pre">geography</span></tt> type.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Different spatial databases have different approaches for &#8220;handling geographics&#8221;</p>
<ul class="last simple">
<li>Oracle attempts to paper over the differences by transparently doing geographic calculations when the SRID is geographic.</li>
<li>SQL Server uses two spatial types, &#8220;STGeometry&#8221; for cartesian data and &#8220;STGeography&#8221; for geographics.</li>
<li>Informix Spatial is a pure cartesian extension to Informix, while Informix Geodetic is a pure geographic extension.</li>
<li>Similar to SQL Server, PostGIS uses two types, &#8220;geometry&#8221; and &#8220;geography&#8221;.</li>
</ul>
</div>
<p>Using the <tt class="docutils literal"><span class="pre">geography</span></tt> instead of <tt class="docutils literal"><span class="pre">geometry</span></tt> type, let&#8217;s try again to measure the distance between Los Angeles and Paris. Instead of <strong class="command">ST_GeometryFromText(text)</strong>, we will use <strong class="command">ST_GeographyFromText(text)</strong>.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">ST_Distance</span><span class="p">(</span>
  <span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;POINT(-118.4079 33.9434)&#39;</span><span class="p">),</span> <span class="c1">-- Los Angeles (LAX)</span>
  <span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;POINT(2.5559 49.0083)&#39;</span><span class="p">)</span>     <span class="c1">-- Paris (CDG)</span>
  <span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">9124665.26917268</span>
</pre></div>
</div>
<p>A big number! All return values from <tt class="docutils literal"><span class="pre">geography</span></tt> calculations are in meters, so our answer is 9124km.</p>
<p>Older versions of PostGIS supported very basic calculations over the sphere using the <strong class="command">ST_Distance_Spheroid(point, point, measurement)</strong> function. However, <strong class="command">ST_Distance_Spheroid</strong> is substantially limited. The function only works on points and provides no support for indexing across the poles or international dateline.</p>
<p>The need to support non-point geometries becomes very clear when posing a question like &#8220;How close will a flight from Los Angeles to Paris come to Iceland?&#8221;</p>
<img alt="_images/lax_cdg.jpg" src="_images/lax_cdg.jpg" />
<p>Working with geographic coordinates on a cartesian plane (the purple line) yields a <em>very</em> wrong answer indeed! Using great circle routes (the red lines) gives the right answer. If we convert our LAX-CDG flight into a line string and calculate the distance to a point in Iceland using <tt class="docutils literal"><span class="pre">geography</span></tt> we&#8217;ll get the right answer (recall) in meters.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">ST_Distance</span><span class="p">(</span>
  <span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;LINESTRING(-118.4079 33.9434, 2.5559 49.0083)&#39;</span><span class="p">),</span> <span class="c1">-- LAX-CDG</span>
  <span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;POINT(-21.8628 64.1286)&#39;</span><span class="p">)</span>                        <span class="c1">-- Iceland</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="mf">531773.757079116</span>
</pre></div>
</div>
<p>So the closest approach to Iceland on the LAX-CDG route is a relatively small 532km.</p>
<p>The cartesian approach to handling geographic coordinates breaks down entirely for features that cross the international dateline. The shortest great-circle route from Los Angeles to Tokyo crosses the Pacific Ocean. The shortest cartesian route crosses the Atlantic and Indian Oceans.</p>
<img alt="_images/lax_nrt.png" src="_images/lax_nrt.png" />
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">ST_Distance</span><span class="p">(</span>
  <span class="n">ST_GeometryFromText</span><span class="p">(</span><span class="s1">&#39;Point(-118.4079 33.9434)&#39;</span><span class="p">),</span>  <span class="c1">-- LAX</span>
  <span class="n">ST_GeometryFromText</span><span class="p">(</span><span class="s1">&#39;Point(139.733 35.567)&#39;</span><span class="p">))</span>     <span class="c1">-- NRT (Tokyo/Narita)</span>
    <span class="k">AS</span> <span class="n">geometry_distance</span><span class="p">,</span>
<span class="n">ST_Distance</span><span class="p">(</span>
  <span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;Point(-118.4079 33.9434)&#39;</span><span class="p">),</span> <span class="c1">-- LAX</span>
  <span class="n">ST_GeographyFromText</span><span class="p">(</span><span class="s1">&#39;Point(139.733 35.567)&#39;</span><span class="p">))</span>    <span class="c1">-- NRT (Tokyo/Narita)</span>
    <span class="k">AS</span> <span class="n">geography_distance</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-python"><pre> geometry_distance | geography_distance
-------------------+--------------------
  258.146005837336 |   8833954.76996256</pre>
</div>
<div class="section" id="using-geography">
<h2>Using Geography<a class="headerlink" href="#using-geography" title="Permalink to this headline">¶</a></h2>
<p>In order to load geometry data into a geography table, the geometry first needs to be projected into EPSG:4326 (longitude/latitude), then it needs to be changed into geography.  The <strong class="command">ST_Transform(geometry,srid)</strong> function converts coordinates to geographics and the <strong class="command">Geography(geometry)</strong> function &#8220;casts&#8221; them from geometry to geography.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">nyc_subway_stations_geog</span> <span class="k">AS</span>
<span class="k">SELECT</span>
  <span class="n">Geography</span><span class="p">(</span><span class="n">ST_Transform</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span><span class="mi">4326</span><span class="p">))</span> <span class="k">AS</span> <span class="n">geog</span><span class="p">,</span>
  <span class="n">name</span><span class="p">,</span>
  <span class="n">routes</span>
<span class="k">FROM</span> <span class="n">nyc_subway_stations</span><span class="p">;</span>
</pre></div>
</div>
<p>Building a spatial index on a geography table is exactly the same as for geometry:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">INDEX</span> <span class="n">nyc_subway_stations_geog_gix</span>
<span class="k">ON</span> <span class="n">nyc_subway_stations_geog</span> <span class="k">USING</span> <span class="n">GIST</span> <span class="p">(</span><span class="n">geog</span><span class="p">);</span>
</pre></div>
</div>
<p>The difference is under the covers: the geography index will correctly handle queries that cover the poles or the international date-line, while the geometry one will not.</p>
<p>There are only a small number of native functions for the geography type:</p>
<ul class="simple">
<li><strong class="command">ST_AsText(geography)</strong> returns <tt class="docutils literal"><span class="pre">text</span></tt></li>
<li><strong class="command">ST_GeographyFromText(text)</strong> returns <tt class="docutils literal"><span class="pre">geography</span></tt></li>
<li><strong class="command">ST_AsBinary(geography)</strong> returns <tt class="docutils literal"><span class="pre">bytea</span></tt></li>
<li><strong class="command">ST_GeogFromWKB(bytea)</strong> returns <tt class="docutils literal"><span class="pre">geography</span></tt></li>
<li><strong class="command">ST_AsSVG(geography)</strong> returns <tt class="docutils literal"><span class="pre">text</span></tt></li>
<li><strong class="command">ST_AsGML(geography)</strong> returns <tt class="docutils literal"><span class="pre">text</span></tt></li>
<li><strong class="command">ST_AsKML(geography)</strong> returns <tt class="docutils literal"><span class="pre">text</span></tt></li>
<li><strong class="command">ST_AsGeoJson(geography)</strong> returns <tt class="docutils literal"><span class="pre">text</span></tt></li>
<li><strong class="command">ST_Distance(geography, geography)</strong> returns <tt class="docutils literal"><span class="pre">double</span></tt></li>
<li><strong class="command">ST_DWithin(geography, geography, float8)</strong> returns <tt class="docutils literal"><span class="pre">boolean</span></tt></li>
<li><strong class="command">ST_Area(geography)</strong> returns <tt class="docutils literal"><span class="pre">double</span></tt></li>
<li><strong class="command">ST_Length(geography)</strong> returns <tt class="docutils literal"><span class="pre">double</span></tt></li>
<li><strong class="command">ST_Covers(geography, geography)</strong> returns <tt class="docutils literal"><span class="pre">boolean</span></tt></li>
<li><strong class="command">ST_CoveredBy(geography, geography)</strong> returns <tt class="docutils literal"><span class="pre">boolean</span></tt></li>
<li><strong class="command">ST_Intersects(geography, geography)</strong> returns <tt class="docutils literal"><span class="pre">boolean</span></tt></li>
<li><strong class="command">ST_Buffer(geography, float8)</strong> returns <tt class="docutils literal"><span class="pre">geography</span></tt> <a class="footnote-reference" href="#casting-note" id="id1">[1]</a></li>
<li><strong class="command">ST_Intersection(geography, geography)</strong> returns <tt class="docutils literal"><span class="pre">geography</span></tt> <a class="footnote-reference" href="#casting-note" id="id2">[1]</a></li>
</ul>
</div>
<div class="section" id="creating-a-geography-table">
<h2>Creating a Geography Table<a class="headerlink" href="#creating-a-geography-table" title="Permalink to this headline">¶</a></h2>
<p>The SQL for creating a new table with a geography column is much like that for creating a geometry table. However, geography includes the ability to specify the object type directly at the time of table creation. For example:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">airports</span> <span class="p">(</span>
  <span class="n">code</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
  <span class="n">geog</span> <span class="n">GEOGRAPHY</span><span class="p">(</span><span class="n">Point</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">airports</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;LAX&#39;</span><span class="p">,</span> <span class="s1">&#39;POINT(-118.4079 33.9434)&#39;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">airports</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;CDG&#39;</span><span class="p">,</span> <span class="s1">&#39;POINT(2.5559 49.0083)&#39;</span><span class="p">);</span>
<span class="k">INSERT</span> <span class="k">INTO</span> <span class="n">airports</span> <span class="k">VALUES</span> <span class="p">(</span><span class="s1">&#39;REK&#39;</span><span class="p">,</span> <span class="s1">&#39;POINT(-21.8628 64.1286)&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>In the table definition, the <tt class="docutils literal"><span class="pre">GEOGRAPHY(Point)</span></tt> specifies our airport data type as points. The new geography fields don&#8217;t get registered in the <tt class="docutils literal"><span class="pre">geometry_columns</span></tt> view. Instead, they are registered in a view called <tt class="docutils literal"><span class="pre">geography_columns</span></tt>.</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">geography_columns</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-python"><pre>          f_table_name         | f_geography_column | srid |   type
-------------------------------+--------------------+------+----------
 nyc_subway_stations_geography | geog               |    0 | Geometry
 airports                      | geog               | 4326 | Point</pre>
</div>
</div>
<div class="section" id="casting-to-geometry">
<h2>Casting to Geometry<a class="headerlink" href="#casting-to-geometry" title="Permalink to this headline">¶</a></h2>
<p>While the basic functions for geography types can handle many use cases, there are times when you might need access to other functions only supported by the geometry type. Fortunately, you can convert objects back and forth from geography to geometry.</p>
<p>The PostgreSQL syntax convention for casting is to append <tt class="docutils literal"><span class="pre">::typename</span></tt> to the end of the value you wish to cast. So, <tt class="docutils literal"><span class="pre">2::text</span></tt> with convert a numeric two to a text string &#8216;2&#8217;. And <tt class="docutils literal"><span class="pre">'POINT(0</span> <span class="pre">0)'::geometry</span></tt> will convert the text representation of point into a geometry point.</p>
<p>The <strong class="command">ST_X(point)</strong> function only supports the geometry type. How can we read the X coordinate from our geographies?</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">SELECT</span> <span class="n">code</span><span class="p">,</span> <span class="n">ST_X</span><span class="p">(</span><span class="n">geog</span><span class="p">::</span><span class="n">geometry</span><span class="p">)</span> <span class="k">AS</span> <span class="n">longitude</span> <span class="k">FROM</span> <span class="n">airports</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-python"><pre> code | longitude
------+-----------
 LAX  | -118.4079
 CDG  |    2.5559
 REK  |  -21.8628</pre>
</div>
<p>By appending <tt class="docutils literal"><span class="pre">::geometry</span></tt> to our geography value, we convert the object to a geometry with an SRID of 4326. From there we can use as many geometry functions as strike our fancy. But, remember &#8211; now that our object is a geometry, the coordinates will be interpretted as cartesian coordinates, not spherical ones.</p>
</div>
<div class="section" id="why-not-use-geography">
<h2>Why (Not) Use Geography<a class="headerlink" href="#why-not-use-geography" title="Permalink to this headline">¶</a></h2>
<p>Geographics are universally accepted coordinates &#8211; everyone understands what latitude/longitude mean, but very few people understand what UTM coordinates mean. Why not use geography all the time?</p>
<ul class="simple">
<li>First, as noted earlier, there are far fewer functions available (right now) that directly support the geography type. You may spend a lot of time working around geography type limitations.</li>
<li>Second, the calculations on a sphere are computationally far more expensive than cartesian calculations. For example, the cartesian formula for distance (Pythagoras) involves one call to sqrt(). The spherical formula for distance (Haversine) involves two sqrt() calls, an arctan() call, four sin() calls and two cos() calls. Trigonometric functions are very costly, and spherical calculations involve a lot of them.</li>
</ul>
<p>The conclusion?</p>
<p>If your data is geographically compact (contained within a state, county or city), use the <tt class="docutils literal"><span class="pre">geometry</span></tt> type with a cartesian projection that makes sense with your data. See the <a class="reference external" href="http://spatialreference.org">http://spatialreference.org</a> site and type in the name of your region for a selection of possible reference systems.</p>
<p>If, on the other hand, you need to measure distance with a dataset that is geographically dispersed (covering much of the world), use the <tt class="docutils literal"><span class="pre">geography</span></tt> type. The application complexity you save by working in <tt class="docutils literal"><span class="pre">geography</span></tt> will offset any performance issues. And, casting to <tt class="docutils literal"><span class="pre">geometry</span></tt> can offset most functionality limitations.</p>
</div>
<div class="section" id="function-list">
<h2>Function List<a class="headerlink" href="#function-list" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://postgis.net/docs/manual-2.1/ST_Distance.html">ST_Distance(geometry, geometry)</a>: For geometry type Returns the 2-dimensional cartesian minimum distance (based on spatial ref) between two geometries in projected units. For geography type defaults to return spheroidal minimum distance between two geographies in meters.</p>
<p><a class="reference external" href="http://postgis.net/docs/manual-2.1/ST_GeographyFromText.html">ST_GeographyFromText(text)</a>: Returns a specified geography value from Well-Known Text representation or extended (WKT).</p>
<p><a class="reference external" href="http://postgis.net/docs/manual-2.1/ST_Transform.html">ST_Transform(geometry, srid)</a>: Returns a new geometry with its coordinates transformed to the SRID referenced by the integer parameter.</p>
<p><a class="reference external" href="http://postgis.net/docs/manual-2.1/ST_X.html">ST_X(point)</a>: Returns the X coordinate of the point, or NULL if not available. Input must be a point.</p>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="casting-note" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id2">2</a>)</em> <p>The buffer and intersection functions are actually wrappers on top of a cast to geometry, and are not carried out natively in spherical coordinates. As a result, they may fail to return correct results for objects with very large extents that cannot be cleanly converted to a planar representation.</p>
<p class="last">For example, the <strong class="command">ST_Buffer(geography,distance)</strong> function transforms the geography object into a &#8220;best&#8221; projection, buffers it, and then transforms it back to geographics. If there is no &#8220;best&#8221; projection (the object is too large), the operation can fail or return a malformed buffer.</p>
</td></tr>
</tbody>
</table>
</div>
</div>


      <!-- Next/Prev -->
      <div class="selfclear pagination-nav">
          <div class="left"><strong>Previous</strong>: <a href="projection_exercises.html" title="previous chapter">Section 16: Projection Exercises</a></div>
          <div class="right"><strong>Next</strong>: <a href="geometry_returning.html" title="next chapter">Section 18: Geometry Constructing Functions</a></div>
      </div>

  </div> <!-- rightbar_main -->

  <div id="rightbar_bar">
    
      <div id="toc" class="section">
        <h4 class="pngfix">Page Contents</h4>
        <ul>
<li><a class="reference internal" href="#">Section 17: Geography</a><ul>
<li><a class="reference internal" href="#using-geography">Using Geography</a></li>
<li><a class="reference internal" href="#creating-a-geography-table">Creating a Geography Table</a></li>
<li><a class="reference internal" href="#casting-to-geometry">Casting to Geometry</a></li>
<li><a class="reference internal" href="#why-not-use-geography">Why (Not) Use Geography</a></li>
<li><a class="reference internal" href="#function-list">Function List</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section">
          <h3>Continue Reading</h3>
          <p style="margin-top:1em"><b>Previous:</b> <a href="projection_exercises.html" title="previous chapter">Section 16: Projection Exercises</a></p>
          <p><b>Next:</b> <a href="geometry_returning.html" title="next chapter">Section 18: Geometry Constructing Functions</a></p>
          </ul>
        </div>

   <h4>About Boundless</h4>
   <p>Boundless provides <a href="http://boundlessgeo.com/solutions/">commercial open source software</a> for internet mapping and geospatial application development. We are dedicated to the growth and support of open source software.</p>

    <h4>License</h4>
    <p>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">Creative Commons Non Commercial-Attribution-Share Alike 3.0 United States License</a>.  Feel free to use this material, but we ask that you please retain the Boundless branding, logos and style.</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-nc-sa/3.0/88x31.png" /></a></p>
<!--
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="geometry_returning.html" title="Section 18: Geometry Constructing Functions"
       accesskey="N">next</a></li>
  <li>
    <a href="projection_exercises.html" title="Section 16: Projection Exercises"
       accesskey="P">previous</a>|</li>
</ul> -->
  </div> <!-- rightbar_bar -->

  </div> <!-- content -->
  <div id="footer">
    <footer id="colophon" class="site-footer" role="contentinfo">
		<div class="container">
			<div class="row">
				<div class="span2">
					<h5>Solutions</h5>
					<div class="footer-solutions-menu">
						<ul id="menu-solutions" class="menu">
							<li><a href="http://boundlessgeo.com/solutions/">Overview</a></li>
							<li><a href="http://boundlessgeo.com/opengeo-suite/">OpenGeo Suite</a></li>
							<li><a href="http://boundlessgeo.com/solutions/mapmeter/">MapMeter</a></li>
							<li><a href="http://boundlessgeo.com/solutions/solutions-software/">Software</a></li>
							<li><a href="http://boundlessgeo.com/solutions/solutions-industry/">Industries</a></li>
						</ul>
					</div>
				</div>
				<div class="span2">
					<h5>Resources</h5>
					<div class="footer-resources-menu">
						<ul id="menu-resources" class="menu">
              <li><a href="http://boundlessgeo.com/resources/">Overview</a></li>
							<li><a href="http://boundlessgeo.com/documentation/">Documentation</a></li>
							<li><a href="http://boundlessgeo.com/resources/trainings/">Trainings</a></li>
							<li><a href="http://workshops.boundlessgeo.com/">Workshops</a></li>
							<li><a href="http://boundlessgeo.com/case-studies/">Case Studies</a></li>
							<li><a href="http://boundlessgeo.com/resources/white-papers/">White Papers</a></li>
						</ul>
					</div>
				</div>
				<div class="span2">
					<h5>About Us</h5>
					<div class="footer-about-menu">
						<ul id="menu-about-menu" class="menu">
              <li><a href="http://boundlessgeo.com/about/">Overview</a></li>
							<li><a href="http://boundlessgeo.com/why-boundless/">Why Boundless</a></li>
							<li><a href="http://boundlessgeo.com/about/team/">Team</a></li>
							<li><a href="http://boundlessgeo.com/resources/careers/">Careers</a></li>
							<li><a href="http://boundlessgeo.com/resources/partners/">Partners</a></li>
							<li><a href="http://boundlessgeo.com/blog/">Blog</a></li>
							<li><a href="http://boundlessgeo.com/resources/news/">News &amp; Media</a></li>
              <li><a href="http://boundlessgeo.com/general-information/">Contact</a></li>
            </ul></div>
  				</div>

				<div class="span6 site-info">

					<div class="row-fluid">
						<div class="span6">
							<h5>Contact</h5>
							<p class="address">
								<span>155 Water Street, Suite 4-10</span>
								<span>Brooklyn, NY 11201</span>
								<span>1-877-673-6436</span>
								<span>contact@boundlessgeo.com</span>
							</p>
						</div>
						<div class="span6">
							<span class="social"><i class="twitter"></i><a href="https://twitter.com/boundlessgeo" target="_blank">Follow us on Twitter</a></span>
							<span class="social"><i class="linkedIn"></i><a href="http://www.linkedin.com/company/boundlessgeo" target="_blank">Follow us on Linkedin</a></span>
						</div>
					</div>

				</div>
			</div>
			<div class="row">
				<div class="span12 footer-sub-menu">
					<div class="menu-footer-menu-container">
						<ul id="menu-footer-menu" class="menu">
							<li><a href="http://boundlessgeo.com/terms-service/">Terms of Service</a></li>
							<li><a href="http://boundlessgeo.com/privacy-policy/">Privacy Policy</a></li>
							<li><a href="http://boundlessgeo.com/site-map/">Site Map</a></li>
							<li><a href="http://boundlessgeo.com/">© Boundless</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
		<a class="question btn btn-primary" href="http://boundlessgeo.com/general-information/?contact-variable=ask_a_question"><i class="bubble"></i>Ask A Question</a>
	</footer>
  </div><!-- footer -->

</div><!-- container -->

<script type="text/javascript" src="http://boundlessgeo.com/wp-content/themes/open-geo/js/dropdown.js"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-3879903-6");
pageTracker._trackPageview();
} catch(err) {}
</script>

  </body>
</html>